# Phase change models in Basilisk solver #

The objective of this section is to develop phase-change models in Basilisk solvers in order to simulate evaporation, condensation, film boiling etc.
- The basic procedures are as follows:
    - calculating mass flux
    - solve geometric VOF equations
    - solve energy equation
    - solve N-S equation combined with mass flux in projection step
## Calculating mass flux (mass transfer models)
- Before developing mass transfer models, we use constant mass flux without heat transfer for droplet evaporation (see <a href = "https://github.com/GabrielGLK/thesis-cases/tree/master/phase-change/test_cases/mass_constant" > case-evaporation  </a> ). Because in this test case, we just focus on the numerical methods in solving VOF and N-S equation. See one review [paper](https://github.com/GabrielGLK/thesis-cases/blob/master/reference-papers/phase-change/review/Kharangate%20and%20Mudawar%20-%202017%20-%20Review%20of%20computational%20studies%20on%20boiling%20and%20con.pdf)
    - **The geometric VOF methods with mass transfer**    
        In Basilisk, the geometric VOF method is adopt to track two immicible phase interface, which including interface reconstruction (at beginning of each time step) and interface advection (consistent VOF flux and WY scheme is used). One thing needs to be noted that in interface advection step, the prediction of fluid is divergence-free. Therefore, the VOF methods maybe not available directly to the existed VOF method due to the phase change source term. Actually, people more like to use level-set method to simulate phase-cahnge problems, and the divergence-free problem in VOF equation sometimes not considered. Here, we use the idea of Leon Malan to extend the liquid domain to vapor domain and the difference between origin vapor velocity and ghost domain velocity would produce a divergene-free velocity for the entire computational domain. The details of this method we refer you to read the <a href = "https://github.com/GabrielGLK/thesis-cases/blob/master/reference-papers/phase-change/VOF/extended-VOF/Malan%20%E7%AD%89%E3%80%82%20-%202020%20-%20A%20geometric%20vof%20method%20for%20interface%20resolved%20phas.pdf" > paper  </a>.

        - Interface advecting with an extended, divergence free liquid velocity for the entire domain.  
            A little difference with Leon's mehod is we extend the liquid domain into entire domain, which is more easier to implement in Basilisk. 
        - Shifting the interface to account for phase change  
            Many people just add source term in the RHS of the VOF equation, we can also use this way. Another method is to reconstruct interface after mass source.
    - **Adding mass flux in Poisson projection step**    
        The mass continuity is changed due to phase change, which would affect the expression for solving pressure and velocity using projection method. We need to add this term in the RHS of projection step to indicate mass transfer at interface. See the <a href = "https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/test_cases/phase_change_code/poisson-pc.h#L518" > code  </a> ).
    
    - **Problem in constant mass flux**    
        - As <a href = "https://github.com/GabrielGLK/thesis-cases/blob/master/reference-papers/phase-change/mass-transfer-model/sharp-interface-model/Zhang%20%E5%92%8C%20Ni%20-%202018%20-%20Direct%20numerical%20simulations%20of%20incompressible%20mul.pdf" > Zhang </a>'s conclusion using Gerris, large density ratio will cause interface instability, they used <a href = "https://github.com/GabrielGLK/thesis-cases/blob/master/reference-papers/phase-change/mass-transfer-model/schrage-model/Hardt%20and%20Wondra%20-%202008%20-%20Evaporation%20model%20for%20interfacial%20flows%20based%20on%20a.pdf" > Hardt </a>'s mass diffusion model to solve this problem. See the <a href = "https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/test_cases/phase_change_code/phase-change.h#L76"> code </a>.  
        - Another method we tried is using delta function to impose the mass flux at interface and used smoothed method for mass flux. see <a href = "https://github.com/GabrielGLK/thesis-cases/blob/master/reference-papers/phase-change/mass-transfer-model/schrage-model/Hardt%20and%20Wondra%20-%202008%20-%20Evaporation%20model%20for%20interfacial%20flows%20based%20on%20a.pdf" > Hardt </a>'s mass diffusion model to solve this problem. See the <a href = "https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/test_cases/phase_change_code/phase-change.h#L52"> code </a>.
- Mass transfer models 
In this section, we introduce several mass transfer models in order to calculate mass flux at the interface. The mass transfer models are all implemented in Basilisk solver.
    -  **The Lee model**    
        The model is the simplest mass transfer model. There is an intensity factor we need to change for different phase change phenomenon. #This is important and I will give the values for different physical problems later#. See the <a href = "https://github.com/GabrielGLK/thesis-cases/tree/master/reference-papers/phase-change/mass-transfer-model/Lee-model"> reference </a> and <a href = "https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/test_cases/phase_change_code/phase-change.h#L112"> code </a>.
    - **The Tanasawa model**    
        This model is a simplified expression of schrage model. Similar to the Lee model, there is an mass transfer efficient needs to be defined, the difference is this model computes mass flux from the view of molecular dynamic. See the [reference](https://github.com/GabrielGLK/thesis-cases/tree/master/reference-papers/phase-change/mass-transfer-model/schrage-model)  and [code](https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/test_cases/phase_change_code/phase-change.h#L148).
    - **The sharp interface model**    
        The sharp interface model is based on the Rankineâ€“Hungoniot jump conditions under energy conservation. In the present models, we would like to use two different sharp interface models. The first one is similar to the embeded boundary method which gives a specific value at interface, then we utilize stefan relation to calculate heat flux combining both sides of interface. The other one is calculate the gradient of temperature using [Quentin](http://basilisk.fr/sandbox/qmagdelaine/phase_change/elementary_body.h)'s method in Basilisk, but it's different that we just use this method to calculate temperature gradient. See the figure ![here](https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/figure/temperature_gradient.pdf) to describe the calculation of temperature gradient. This mass transfer model can be found [here](https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/test_cases/phase_change_code/phase-change.h#L313).
    - **The other models**    
        There are also some other mass transfer models, such as [Ratter](https://github.com/GabrielGLK/thesis-cases/tree/master/reference-papers/phase-change/mass-transfer-model/Lee-model/Rattner%20model) model, [Sun](https://github.com/GabrielGLK/thesis-cases/blob/master/reference-papers/phase-change/mass-transfer-model/other-models/2/Sun%20%E7%AD%89%E3%80%82%20-%202014%20-%20Modeling%20of%20the%20Evaporation%20and%20Condensation%20Phase.pdf)'s model which are easy to implement. However, we expect to finish Leon Malan's general mass flux model in Basilisk.
## Solving energy equation
In Basilisk, we solve the advection of passive scalar, such as temperature, using [tracer.h](http://basilisk.fr/src/tracer.h), which is solved by BCG scheme in spacial and first Euler explicit scheme in time. The diffusion of passive tracers uses [diffusion.h](http://basilisk.fr/src/diffusion.h), which is solved by multigrid [poisson](http://basilisk.fr/src/poisson.h) solver in space and first Euler implicit scheme. We can treat heat source term in [diffusion.h](http://basilisk.fr/src/diffusion.h) by several methods.
- **Equilibrium thermal heat transfer model**  
This model is inspired from Ratter model and Quentin's evaporation model. The objective is to keep the interfacial cell saturated temperature. Therefore, in each diffusion time, the extral temperature will be removed from interface. See the [code](https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/test_cases/phase_change_code/phase-change.h#L404).
- **Ghost cell model**  
In [zhang](https://github.com/GabrielGLK/thesis-cases/blob/master/reference-papers/phase-change/mass-transfer-model/sharp-interface-model/Zhang%20%E5%92%8C%20Ni%20-%202018%20-%20Direct%20numerical%20simulations%20of%20incompressible%20mul.pdf)'s paper, they used one called ghost cell method to impose the neighboring cells of interface in saturated phase saturated state. As see in the Figure ![here](https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/figure/ghost_cell_method.pdf). See the [code](https://github.com/GabrielGLK/thesis-cases/blob/master/phase-change/test_cases/phase_change_code/phase-change.h#L16).
## Solving Navier-Stokes equations with phase change
The procedure of solving N-S equations with phase change is similar to one without phase change in Basilisk. The time integration is refereed to read [centered.h](http://basilisk.fr/src/navier-stokes/centered.h). The spacial discretization for advection term [here](http://basilisk.fr/src/bcg.h), viscous term [here](http://basilisk.fr/src/viscosity.h). The method to decouple pressure and velocity is in [poisson.h](http://basilisk.fr/src/poisson.h). In addition, for other extral accelerations, such as gravity (using [reduced.h](http://basilisk.fr/src/reduced.h) model), surface tension (using CSF(http://basilisk.fr/src/tension.h) model). Basilisk used well balanced method to relate these forces contribution with pressure gradient to solve the system acceleration.
        